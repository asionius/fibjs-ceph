<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>

<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Javascript on Fiber: Beginning</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Javascript on Fiber
   </div>
   <div id="projectbrief">A developement framework of the coroutines based on Google&#39;s V8 Engine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->

<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d2/de8/start_prog.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Beginning </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#program_sec">Beginning</a><ul><li class="level2"><a href="#prg_step1">Step 1: Hello, World!</a></li>
<li class="level2"><a href="#prg_step2">Step 2: DANG, DANG, DANG...</a></li>
<li class="level2"><a href="#prg_step3">Step 3: DANGs</a></li>
<li class="level2"><a href="#prg_step4">Advance: Parallel Jobs</a></li>
<li class="level2"><a href="#prg_step5">More Advance: Asynchronous Jobs</a></li>
<li class="level2"><a href="#prg_step10">Summary</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="program_sec"></a>
Beginning</h1>
<h2><a class="anchor" id="prg_step1"></a>
Step 1: Hello, World!</h2>
<p>Choose your prefered editor and create hello.js under bin: </p><div class="fragment"><div class="line"><a class="code" href="../../dc/daa/namespaceconsole.html">console</a>.log(<span class="stringliteral">&#39;Hello, World!&#39;</span>);</div></div><!-- fragment --><p>And then run: </p><div class="fragment"><div class="line">Release/fibjs hello</div></div><!-- fragment --><p>Output as follows: </p><div class="fragment"><div class="line">Hello, World!</div></div><!-- fragment --><p>Yes, it’s so easy like ‘Hello, Wolrd!’ example of others languages.</p>
<h2><a class="anchor" id="prg_step2"></a>
Step 2: DANG, DANG, DANG...</h2>
<p>And then, let’s make a simple program simulating a bell, whick makes a jow ‘DANG’ every second. Of course you can set a longer interval. </p><div class="fragment"><div class="line">var <a class="code" href="../../d6/d05/namespacecoroutine.html">coroutine</a> = require(<span class="stringliteral">&quot;coroutine&quot;</span>);</div><div class="line"></div><div class="line"><span class="keywordflow">while</span>(<span class="keyword">true</span>){</div><div class="line">  <a class="code" href="../../dc/daa/namespaceconsole.html">console</a>.log(<span class="stringliteral">&#39;DANG...&#39;</span>);</div><div class="line">  coroutine.sleep(1000);</div><div class="line">}</div></div><!-- fragment --><p>When running, it will output a ‘DANG’ every second on the screen: </p><div class="fragment"><div class="line">DANG...</div><div class="line">DANG...</div><div class="line">DANG...</div><div class="line">......</div></div><!-- fragment --><p>It is to be noted that you have to run ctrl+c to terminate. If not, it will run forever.</p>
<h2><a class="anchor" id="prg_step3"></a>
Step 3: DANGs</h2>
<p>As the example above, there is only a bell at a time, whick is not what we expected. What we expect is that, more than a bell exist and make jows at the same time.</p>
<div class="fragment"><div class="line">var coroutine = require(<span class="stringliteral">&quot;coroutine&quot;</span>);</div><div class="line"></div><div class="line"><span class="keyword">function</span> dang(n){</div><div class="line">  <span class="keywordflow">while</span>(<span class="keyword">true</span>){</div><div class="line">    <a class="code" href="../../dc/daa/namespaceconsole.html">console</a>.log(<span class="stringliteral">&#39;DANG %d...&#39;</span>, n);</div><div class="line">    coroutine.sleep(1000);</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordflow">for</span>(var i = 0; i &lt; 5; i ++)</div><div class="line">  coroutine.start(dang,i);</div><div class="line"></div><div class="line"><span class="keywordflow">while</span>(<span class="keyword">true</span>)</div><div class="line">  coroutine.sleep(1000);</div></div><!-- fragment --><p>Now there is 5 bells; everyone make a ‘DANG’ per second concurrently. </p><div class="fragment"><div class="line">DANG 0...</div><div class="line">DANG 1...</div><div class="line">DANG 2...</div><div class="line">DANG 3...</div><div class="line">DANG 4...</div><div class="line">...</div><div class="line">DANG 0...</div><div class="line">DANG 1...</div><div class="line">DANG 2...</div><div class="line">DANG 3...</div><div class="line">DANG 4...</div><div class="line">...</div></div><!-- fragment --><p>Also, we could make a small change to make the ‘DANG’s seem more natrual. Don’t jow at the same time. </p><div class="fragment"><div class="line">var coroutine = require(<span class="stringliteral">&quot;coroutine&quot;</span>);</div><div class="line"></div><div class="line"><span class="keyword">function</span> dang(n){</div><div class="line">  <span class="keywordflow">while</span>(<span class="keyword">true</span>){</div><div class="line">    <a class="code" href="../../dc/daa/namespaceconsole.html">console</a>.log(<span class="stringliteral">&#39;DANG %d...&#39;</span>, n);</div><div class="line">    coroutine.sleep(1000);</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordflow">for</span>(var i = 0; i &lt; 5; i ++){</div><div class="line">  coroutine.start(dang,i);</div><div class="line">  coroutine.sleep(200);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordflow">while</span>(<span class="keyword">true</span>)</div><div class="line">  coroutine.sleep(1000);</div></div><!-- fragment --><h2><a class="anchor" id="prg_step4"></a>
Advance: Parallel Jobs</h2>
<p>With the help of coroutine, we can accomplish many funny things. Of course, we could deal with the same things by more funny ways. In many cases, there are some seperate database operations at a request. By means of coroutine, we could dispatch these operations into seperate coroutine tasks and make them handled parellelly. Obviously, it will be faster to response. </p><div class="fragment"><div class="line">var coroutine = require(<span class="stringliteral">&quot;coroutine&quot;</span>);</div><div class="line"></div><div class="line"><span class="keyword">function</span> func(){</div><div class="line">  coroutine.parallel(<span class="keyword">function</span>(){</div><div class="line">    ...</div><div class="line">  }, <span class="keyword">function</span>(){</div><div class="line">    ...</div><div class="line">  }, <span class="keyword">function</span>(){</div><div class="line">    ...</div><div class="line">  }, <span class="keyword">function</span>(){</div><div class="line">    ...</div><div class="line">  });</div><div class="line">}</div></div><!-- fragment --><p>Anonymous functions in the above section will be executed concurrently. After all functions finish, it goes on. </p>
<h2><a class="anchor" id="prg_step5"></a>
More Advance: Asynchronous Jobs</h2>
<p>Also, for a request, some operations don’t need response immediately; only ones that user are sensitive about will be got a reponse before timeout of the request. To make the response faster, we could process these requests asynchronusly, which users will not be sensitive about instantly. </p><div class="fragment"><div class="line">var coroutine = require(<span class="stringliteral">&quot;coroutine&quot;</span>);</div><div class="line"></div><div class="line"><span class="keyword">function</span> func(){</div><div class="line">  ...</div><div class="line"></div><div class="line">  coroutine.start(<span class="keyword">function</span>(){</div><div class="line">    ...</div><div class="line">  });</div><div class="line"></div><div class="line">  ...</div><div class="line">}</div></div><!-- fragment --><p>The anonymous function above will be delayed to execute.</p>
<h2><a class="anchor" id="prg_step10"></a>
Summary</h2>
<p>Let’s start fibjs! With coroutine, it’s more garaceful and delightful to write concurrent code than callbacks. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<style type="text/css">
body {
	color: #666666;
}
a, .contents a:visited {
	color: #3399ee;
}
.icona, #nav-sync {
  display:none;
}
.directory td.entry, .directory td.desc {
  padding: 8px;
}
</style>
</body>
</html>